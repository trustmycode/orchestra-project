server.port=8085

spring.datasource.url=jdbc:postgresql://localhost:5432/${POSTGRES_DB:orchestra}
spring.datasource.username=${POSTGRES_APP_USER:orchestra_app}
spring.datasource.password=${POSTGRES_PASSWORD:orchestra}

# Flyway should run as superuser/owner to manage roles and RLS
spring.flyway.user=${SPRING_FLYWAY_USER:orchestra}
spring.flyway.password=${spring.datasource.password}

spring.jpa.hibernate.ddl-auto=validate

spring.rabbitmq.host=${SPRING_RABBITMQ_HOST:localhost}
spring.rabbitmq.port=5672
spring.rabbitmq.username=${SPRING_RABBITMQ_USER:orchestra}
spring.rabbitmq.password=${SPRING_RABBITMQ_PASSWORD:orchestra}

logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.boot.autoconfigure.web=DEBUG
logging.level.org.springframework.amqp=DEBUG
logging.level.org.springframework.boot.autoconfigure.amqp=DEBUG

# S3 Configuration
orchestra.s3.endpoint=http://minio:9000
orchestra.s3.external-endpoint=http://localhost:9000
orchestra.s3.region=us-east-1
orchestra.s3.access-key=minioadmin
orchestra.s3.secret-key=minioadmin
orchestra.s3.bucket=orchestra-artifacts

# AI & Vector Store Configuration
spring.ai.ollama.base-url=${OLLAMA_BASE_URL:http://localhost:11434}
spring.ai.ollama.embedding.model=mxbai-embed-large

spring.ai.vectorstore.pgvector.index-type=HNSW
spring.ai.vectorstore.pgvector.distance-type=COSINE_DISTANCE
spring.ai.vectorstore.pgvector.dimensions=1024
spring.ai.vectorstore.pgvector.initialize-schema=false
# Re-use main datasource for vector store
spring.ai.vectorstore.pgvector.datasource.url=${spring.datasource.url}

# Admin Datasource (Super User with BYPASSRLS)
orchestra.admin.datasource.url=${spring.datasource.url}
orchestra.admin.datasource.username=orchestra_admin
orchestra.admin.datasource.password=orchestra
