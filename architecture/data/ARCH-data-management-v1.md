---
id: ARCH-data-management
title: "Управление тестовыми данными, окружениями и секретами"
type: feature
layer: application
owner: '@architect'
version: v1
status: planned
created: 2024-07-29
updated: 2024-07-29
tags: [test-data, environment, secrets]
depends_on: [ARCH-data-model]
referenced_by: []
---
## Контекст
Для обеспечения гибкости и переиспользуемости тестов система должна предоставлять механизмы управления тестовыми данными, конфигурациями окружений и безопасного хранения секретов.

## Структура
*   **`TestDataSet`**: Сущность для хранения наборов тестовых данных в формате JSON. Данные из `TestDataSet` могут быть использованы в шагах сценария через плейсхолдеры (например, `{{data.user.id}}`). Поддерживается AI-генерация данных через `ai-service`.
*   **`Environment`**: Сущность, которая определяет набор подключений к тестируемой системе (SUT) для конкретного стенда (dev, qa, prod). Она сопоставляет логические имена (алиасы), используемые в сценариях, с конкретными профилями подключений (`DbConnectionProfile`, `KafkaClusterProfile`).
*   **Управление секретами**: Реализуется двухэтапный подход:
    1.  **MVP / Локальная разработка**: Секреты (пароли, токены) хранятся в переменных окружения (`.env` файлы).
    2.  **Production**: В коде используется абстракция `SecretProvider`, которая интегрируется с внешним менеджером секретов (например, HashiCorp Vault или AWS Secrets Manager).

## Поведение
При запуске теста пользователь выбирает `Environment` и `TestDataSet`. `Execution Engine` использует `Environment` для разрешения подключений к SUT и извлечения секретов, а `TestDataSet` — для параметризации шагов сценария. Это позволяет запускать один и тот же сценарий на разных стендах с разными данными без изменения самого сценария.

## Эволюция
### Планируемые изменения
— Внедрение версионирования для `TestDataSet` и `Environment`.
