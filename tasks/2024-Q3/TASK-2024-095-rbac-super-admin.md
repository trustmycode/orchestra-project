---
id: TASK-2024-095
title: "Задача 4.1.3 (Backend): Контур супер-администратора"
status: backlog
priority: low
type: task
estimate: 8h
created: 2024-07-30
updated: 2024-07-30
parents: [TASK-2024-028]
arch_refs: [ADR-0012, ARCH-security-multitenancy]
audit_log:
  - {date: 2024-07-30, user: "@AI-Codex", action: "created"}
---
## Описание
Создать безопасный контур для супер-администраторов, требующих межтенантного доступа (например, техподдержка, миграции), с отдельным подключением к БД и строгим аудитом, как предписывает `ADR-0012`.

## Ключевые шаги
1. Добавить отдельный `DataSource`/`JdbcTemplate`, использующий учетные данные роли `orchestra_admin`.
2. Выделить API или внутренние сервисы (например, `/api/v1/admin/**`), которые используют привилегированный `DataSource` и защищены ролью `SUPER_ADMIN`.
3. Включить обязательный аудит всех операций (запись в `audit_logs` с указанием пользователя, цели и payload).
4. Продумать процесс выдачи и отзыва супер-прав, включая Keycloak-роли и секреты подключения.

## Критерии приемки
- Супер-администратор может выполнять межтенантные операции только через защищенные эндпоинты/сервисы.
- Обычный `DataSource` не имеет `BYPASSRLS`, и попытка обойти RLS невозможна.
- Все административные действия журналируются и доступны для расследований.
