---
id: TASK-2024-066
title: "Задача 4.9 (AI): Предложение ASSERTION-шагов на основе анализа ACTION-шагов"
status: backlog
priority: low
type: feature
estimate: 20h
created: 2024-07-30
updated: 2024-07-30
parents: [TASK-2024-027]
dependencies: [TASK-2024-097, TASK-2024-098, TASK-2024-023, TASK-2024-024, TASK-2024-036, TASK-2024-073]
arch_refs: [ADR-0016, ADR-0025]
audit_log:
  - {date: 2024-07-30, user: "@RoboticArchitect", action: "created with status backlog"}
---
## Описание
Реализовать AI-функцию, которая анализирует `ACTION`-шаги (например, HTTP POST/PUT) и предлагает пользователю добавить соответствующие `ASSERTION`-шаги для проверки ожидаемых побочных эффектов в базах данных, очередях или Kafka. Логика реализуется через агента `sgr-agent-core`, который использует инструменты `AgentToolbox` и данные `Data Resolver`, чтобы аргументировать свои рекомендации.

## Ключевые шаги
1. Расширить API `ai-service`, добавив эндпоинт для анализа побочных эффектов.
2. В `ai-service` реализовать логику, которая по описанию эндпоинта (метод, путь, схема) генерирует шаблоны для `ASSERTION`-шагов.
3. В UI (`ScenarioBuilderView`) после каждого `ACTION`-шага отображать блок с предложениями от AI.
4. При выборе предложения в сценарий добавляется преднастроенный `ASSERTION`-шаг, который пользователь может доработать.

## Критерии приемки
- После добавления шага `POST /orders`, UI предлагает добавить шаг "Проверить запись в таблице 'orders'".
- Добавленный шаг содержит предполагаемый SQL-запрос с плейсхолдерами и базовые ожидания.
