---
id: TASK-2024-096
title: "Задача 4.11 (DB): Партиционирование горячих таблиц"
status: backlog
priority: low
type: tech_debt
estimate: 16h
created: 2024-07-30
updated: 2024-07-30
parents: [TASK-2024-027]
arch_refs: [ADR-0012, ADR-0003, ARCH-data-model]
audit_log:
  - {date: 2024-07-30, user: "@AI-Codex", action: "created"}
---
## Описание
Внедрить партиционирование для таблиц с высокими нагрузками записи и чтения (в первую очередь `test_step_results`), чтобы облегчить управление объемом данных и улучшить производительность в рамках архитектурных решений `ADR-0003` и `ADR-0012`.

## Ключевые шаги
1. Проанализировать профили нагрузки и обосновать стратегию композитного партиционирования `LIST(tenant_id) + RANGE(created_at)`.
2. Подготовить миграцию, переводящую `test_step_results` на партиционированную структуру и корректно переносящую существующие данные.
3. Настроить автоматическое создание будущих партиций (cron/worker) и процедуры отсоединения/архивации устаревших данных.
4. Обновить мониторинг/алерты, чтобы отслеживать рост таблиц и своевременно создавать партиции.

## Критерии приемки
- `test_step_results` и другие приоритетные таблицы используют выбранную схему партиционирования.
- Partition pruning сокращает время выполнения запросов по `tenant_id` и диапазону дат.
- Описаны и задокументированы процедуры обслуживания новых партиций и очистки старых данных.
